<!-- <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /> -->
<script type="text/javascript">
    //<![CDATA[
    $(function(){
        $.initList( "pageCheckList", "checkItem", true, "/check/json", {"pageType":"page", "limit":"10"}, function(jsonData){
            var values = jsonData.values;
            var size = values.length;
            for(var i = 0; i < size; i++){
                var text = values[i].errorMessage;
                text = text.replace(/\r\n/g, "<br />");
                text = text.replace(/(\n|\r)/g, "<br />");
                values[i].errorMessageWrap = text;
            }
            $.setListValues("pageCheckList", "checkItem", true, jsonData);
            
			$("#error-message").click(function(e){
			    var $this=$(this);
				var	checkId=$this.data("checkId");
			    var $tr=$("#checkItem-error-message-tr-"+checkId);
			    $tr.toggle();
			});
			if(size > 0){
				$('#checkListContainer').show();
			}
        });
        
        $.initList( "loginCheckList", "checkItem", true, "/check/json", {"pageType":"login", "limit":"10"}, function(jsonData){
            var values = jsonData.values;
            var size = values.length;
            for(var i = 0; i < size; i++){
                var text = values[i].errorMessage;
                text = text.replace(/\r\n/g, "<br />");
                text = text.replace(/(\n|\r)/g, "<br />");
                values[i].errorMessageWrap = text;
            }
            $.setListValues("loginCheckList", "checkItem", true, jsonData);
            
			$("#error-message").click(function(e){
			    var $this=$(this);
				var	checkId=$this.data("checkId");
			    var $tr=$("#checkItem-error-message-tr-"+checkId);
			    $tr.toggle();
			});
			
			if(size > 0){
				$('#loginListContainer').show();	
			}
        });
        
        $.initList( "checkLogList", "checkLogItem", false, "/log/json",  {"limit":"10"}, null, null, null, function(){
        	$('#checkLogListContainer').show();	
        });
        
        
    });
    
    //]]>
</script>
<div class="span9">
				<h1 class="page-title">
					<i class="icon-home"></i>
					<span>ダッシュボード</span>					
				</h1>
				<div class="stat-container">
					<div class="stat-holder">						
						<div class="stat">
							<span><liquidtpl:errorCount/></span>
							今日のページエラー数							
						</div> <!-- /stat -->						
					</div> <!-- /stat-holder -->
					<div class="stat-holder">						
						<div class="stat">							
							<span><liquidtpl:checkCount/></span>							
							ページ監視数							
						</div> <!-- /stat -->						
					</div> <!-- /stat-holder -->
					<div class="stat-holder">						
						<div class="stat">							
							<span><liquidtpl:errorLoginCount/></span>							
							今日のログインエラー数							
						</div> <!-- /stat -->						
					</div> <!-- /stat-holder -->
					<div class="stat-holder">						
						<div class="stat">							
							<span><liquidtpl:checkLoginCount/></span>							
							ログイン監視数							
						</div> <!-- /stat -->						
					</div> <!-- /stat-holder -->
				</div> <!-- /stat-container -->
				
				<!-- ページ監視リスト -->
				<div id="checkListContainer" class="widget widget-table hide">
					<div class="widget-header">
						<i class="icon-th-list"></i>
						<h3>ページ監視</h3>
					</div> <!-- /widget-header -->
					<div class="widget-content">
						<table  class="table table-striped table-bordered">
							<thead>
								<tr>
									<th>タイトル</th>
									<th>URL</th>
									<th>有効・無効</th>
									<th>ステータス</th>
									<th>編集</th>
								</tr>
							</thead>
							<tbody id="pageCheckList">
							</tbody>
			
						</table>
					</div> <!-- /widget-content -->
				</div> <!-- /widget -->
				<!-- /ページ監視リスト -->
				
				<!-- ログイン監視リスト -->
				<div id="loginListContainer" class="widget widget-table hide">
					<div class="widget-header">
						<i class="icon-th-list"></i>
						<h3>ログイン監視</h3>
					</div> <!-- /widget-header -->
					<div class="widget-content">
						<table  class="table table-striped table-bordered">
							<thead>
								<tr>
									<th>タイトル</th>
									<th>URL</th>
									<th>有効・無効</th>
									<th>ステータス</th>
									<th>編集</th>
								</tr>
							</thead>
							<tbody id="loginCheckList">
							</tbody>
			
						</table>
					</div> <!-- /widget-content -->
				</div> <!-- /widget -->
				<!-- /ログイン監視リスト -->
				
				<!-- ログリスト -->
				<div id="checkLogListContainer" class="widget widget-table hide">
					<div class="widget-header">
						<i class="icon-th-list"></i>
							<h3>ログ</h3>
						</div> <!-- /widget-header -->
					<div class="widget-content">
						<table  class="table table-striped table-bordered">
							<thead>
								<tr>
									<th><liquidtpl:text key="checkLog.name"/></th>
    								<th><liquidtpl:text key="checkLog.url"/></th>
    								<th class='thin'><liquidtpl:text key="checkLog.status"/></th>
    								<th></th>
								</tr>
							</thead>
							<tbody id="checkLogList">
							</tbody>
						</table>
					</div>
				</div>
				<!-- /ログリスト -->
				
</div> <!-- /row -->
<script id="checkItem" type="text/x-jquery-tmpl">
    <tr>
        <td ><a href="javascript:void(0)" onclick="$('#checkItem-error-message-tr-${id}').toggle();" id="error-message">${name}</a></td>
        <td><a href="${url}" target="_blank">${url}</a></td>
        <td>{{if active=='true'}}<span class="label label-success"><liquidtpl:text key="check.isActive"/></span>{{else}}<span class="label"><liquidtpl:text key="check.isInactive"/></span>{{/if}}</td>
        <td>{{html statusHtml}}</td>
        <td class="action-td"><a href="/check/form?id=${id}" class="btn btn-small btn-warning"><i class="icon-pencil" title="Edit"></i></a>
        <a href="/check/delete?id=${id}" onclick="return confirm('${deleteConfirm}');" class="btn btn-small"><i class="icon-remove" title="Remove"></i></a></td>
    </tr>
    <tr id="checkItem-error-message-tr-${id}" class="selectable error-message-tr" style="display:none;">
        <td colspan="5">
            <textarea id='checkItem-error-message-${id}' class="span8" rows="10" readonly="readonly">{{html errorMessage}}</textarea>
            {{if checkedAt}}<div><liquidtpl:text key="check.LastCheckedAt"/>: ${checkedAt}</div>{{/if}}
        </td>
    </tr>
</script>

<script id="checkLogItem" type="text/x-jquery-tmpl">
  <tr class="selectable">
    <td>${name}</td>
    <td class='thin'>${url}</td>
    <td class="thin{{if status=='D'}} noticeMessage{{else status=='R'}} confirmMessage{{/if}}">{{html statusHtml}}</td>
    <td class="thin">${createdAt}</td>
  </tr>
</script>