<!-- <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /> -->
<link href="/css/pages/reports.css" rel="stylesheet" />
<script type="text/javascript">
//<![CDATA[             
	$(function() {
		$.initList("PlanList", "checkItem", true, "/admin/plan/json", {
			"pageType" : "page",
		}, function(jsonData) {
			var values = jsonData.values;
			var size = values.length;
			$.setListValues("PlanList", "PlanItem", true, jsonData);
			if (size > 0) {
				$('#PlanListContainer').show();
			}
		});

	});

	$.changePlan = function(id) {
		$.post("/admin/plan/change", {
			id : id,
			plan : $("#" + id).val()
		}, function(json) {
			if (json.result == "success") {
				$("#information").show()
				$("#error").hide()
			} else {
				$("#information").hide()
				$("#error").show()
			}
		})
	}

    //]]>
</script>
<div class="span12">
	<div id="information" class="alert alert-info" style="display: none">
		<button type="button" class="close" onclick="$('#information').hide()">×</button>
		<span id="information">プランを変更しました。</span>
	</div>
	<div id="error" class="alert alert-error" style="display: none">
		<button type="button" class="close" onclick="$('#error').hide()">×</button>
		<span id="information">プランの変更に失敗しました。</span>
	</div>
	<!-- ユーザ別プラン状況リスト -->
	<div id="PlanListContainer" class="widget widget-table hide">
		<div class="widget-header">
			<i class="icon-file-alt"></i>
			<h3>ユーザ別プラン状況リスト</h3>
		</div>
		<!-- /widget-header -->
		<div class="widget-content">
			<table class="table table-striped table-bordered">
				<thead>
					<tr>
						<th class="w30">メールアドレス</th>
						<th>プラン</th>
						<th></th>
					</tr>
				</thead>
				<tbody id="PlanList">
				</tbody>

			</table>
		</div>
		<!-- /widget-content -->
	</div>
	<!-- /widget -->
	<!-- ユーザ別プラン状況リスト -->
</div>
<!-- /row -->
<script id="PlanItem" type="text/x-jquery-tmpl">
	<tr>
        <td>${email}</td>
		<td>{{html selectPlan}}</td>
		<td><button class="btn btn-large" onclick="if(window.confirm('${email} のプランを ${planName} に変更しますがよろしいですか？'))$.changePlan('${id}')">変更する</button></td>
    </tr>
</script>

